<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
                "http://www.w3.org/TR/REC-html40/loose.dtd">
<html>
<head>
  <title>Description of ukf_update1</title>
  <meta name="keywords" content="ukf_update1">
  <meta name="description" content="UKF_UPDATE1 -  Additive form Unscented Kalman Filter update step">
  <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
  <meta name="generator" content="m2html &copy; 2003 Guillaume Flandin">
  <meta name="robots" content="index, follow">
  <link type="text/css" rel="stylesheet" href="../m2html.css">
</head>
<body>
<a name="_top"></a>
<div><a href="../index.html">Home</a> &gt;  <a href="index.html">src</a> &gt; ukf_update1.m</div>

<!--<table width="100%"><tr><td align="left"><a href="../index.html"><img alt="<" border="0" src="../left.png">&nbsp;Master index</a></td>
<td align="right"><a href="index.html">Index for src&nbsp;<img alt=">" border="0" src="../right.png"></a></td></tr></table>-->

<h1>ukf_update1
</h1>

<h2><a name="_name"></a>PURPOSE <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
<div class="box"><strong>UKF_UPDATE1 -  Additive form Unscented Kalman Filter update step</strong></div>

<h2><a name="_synopsis"></a>SYNOPSIS <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
<div class="box"><strong>function [M,P,K,MU,S,LH] = ukf_update1(M,P,Y,h,R,param,alpha,beta,kappa,mat) </strong></div>

<h2><a name="_description"></a>DESCRIPTION <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
<div class="fragment"><pre class="comment">UKF_UPDATE1 -  Additive form Unscented Kalman Filter update step

 Syntax:
   [M,P,K,IM,S,LH] = UKF_UPDATE1(M,P,Y,h,R,param,alpha,beta,kappa,mat)

 In:
   M  - Mean state estimate after prediction step
   P  - State covariance after prediction step
   Y  - Measurement vector.
   h  - Measurement model function as a matrix H defining
        linear function h(x) = H*x, inline function,
        function handle or name of function in
        form h(x,param)
   R  - Measurement covariance.
   param - Parameters of a               (optional, default empty)
   alpha - Transformation parameter      (optional)
   beta  - Transformation parameter      (optional)
   kappa - Transformation parameter      (optional)
   mat   - If 1 uses matrix form         (optional, default 0)

 Out:
   M  - Updated state mean
   P  - Updated state covariance
   K  - Computed Kalman gain
   MU - Predictive mean of Y
   S  - Predictive covariance Y
   LH - Predictive probability (likelihood) of measurement.
   
 Description:
   Perform additive form Discrete Unscented Kalman Filter (UKF)
   measurement update step. Assumes additive measurement
   noise.

   Function h should be such that it can be given
   DxN matrix of N sigma Dx1 points and it returns 
   the corresponding measurements for each sigma
   point. This function should also make sure that
   the returned sigma points are compatible such that
   there are no 2pi jumps in angles etc.

 Example:
   h = inline('atan2(x(2,:)-s(2),x(1,:)-s(1))','x','s');
   [M2,P2] = ukf_update(M1,P1,Y,h,R,S);

 See also:
   <a href="ukf_predict1.html" class="code" title="function [M,P] = ukf_predict1(M,P,a,Q,param,alpha,beta,kappa,mat)">UKF_PREDICT1</a>, <a href="ukf_predict2.html" class="code" title="function [M,P] = ukf_predict2(M,P,a,Q,param,alpha,beta,kappa,mat)">UKF_PREDICT2</a>, <a href="ut_transform.html" class="code" title="function [mu,S,C,X,Y,w] = ut_transform(M,P,g,param,alpha,beta,kappa,mat,X,w)">UT_TRANSFORM</a>, <a href="ut_weights.html" class="code" title="function [WM,WC,c] = ut_weights(n,alpha,beta,kappa)">UT_WEIGHTS</a>, <a href="ut_mweights.html" class="code" title="function [WM,W,c] = ut_mweights(n,alpha,beta,kappa)">UT_MWEIGHTS</a>,
   <a href="ut_sigmas.html" class="code" title="function X = ut_sigmas(M,P,c);">UT_SIGMAS</a>

 History:
   04.05.2007 JH Made corrections to the description.
   02.05.2007 JH Fixed a bug in likelihood calculation and added
              a &quot;See also&quot;-section.
   2002-2006  SS Initial version


 References:
   [1] Wan, Merwe: The Unscented Kalman Filter</pre></div>

<!-- crossreference -->
<h2><a name="_cross"></a>CROSS-REFERENCE INFORMATION <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
This function calls:
<ul style="list-style-image:url(../matlabicon.gif)">
<li><a href="gauss_pdf.html" class="code" title="function [P,E] = gauss_pdf(X,M,S)">gauss_pdf</a>	GAUSS_PDF  Multivariate Gaussian PDF</li><li><a href="ut_transform.html" class="code" title="function [mu,S,C,X,Y,w] = ut_transform(M,P,g,param,alpha,beta,kappa,mat,X,w)">ut_transform</a>	UT_TRANSFORM  Perform unscented transform</li></ul>
This function is called by:
<ul style="list-style-image:url(../matlabicon.gif)">
<li><a href="../src/demos/bot_demo/bot_demo_all.html" class="code" title="">bot_demo_all</a>	Bearings Only Tracking (BOT demonstration with EKF1,EKF2 and UKF</li><li><a href="../src/demos/bot_demo/ukfs_bot_demo.html" class="code" title="">ukfs_bot_demo</a>	Bearings Only Tracking (BOT) demonstration with UKF.</li><li><a href="../src/demos/ungm_demo/ungm_demo.html" class="code" title="">ungm_demo</a>	Demonstration of univariate nonstationary growth model (UNGM) using EKF and UKF.</li><li><a href="ufbf_smooth1.html" class="code" title="function [M,P] = ufbf_smooth1(M,P,Y,ia,Q,aparam,h,R,hparam,alpha,beta,kappa,mat,same_p_a,same_p_h)">ufbf_smooth1</a>	UFBF_SMOOTH1  Unscented Forward-Backward Filtering Based Smoother</li></ul>
<!-- crossreference -->


<h2><a name="_source"></a>SOURCE CODE <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
<div class="fragment"><pre>0001 <span class="comment">%UKF_UPDATE1 -  Additive form Unscented Kalman Filter update step</span>
0002 <span class="comment">%</span>
0003 <span class="comment">% Syntax:</span>
0004 <span class="comment">%   [M,P,K,IM,S,LH] = UKF_UPDATE1(M,P,Y,h,R,param,alpha,beta,kappa,mat)</span>
0005 <span class="comment">%</span>
0006 <span class="comment">% In:</span>
0007 <span class="comment">%   M  - Mean state estimate after prediction step</span>
0008 <span class="comment">%   P  - State covariance after prediction step</span>
0009 <span class="comment">%   Y  - Measurement vector.</span>
0010 <span class="comment">%   h  - Measurement model function as a matrix H defining</span>
0011 <span class="comment">%        linear function h(x) = H*x, inline function,</span>
0012 <span class="comment">%        function handle or name of function in</span>
0013 <span class="comment">%        form h(x,param)</span>
0014 <span class="comment">%   R  - Measurement covariance.</span>
0015 <span class="comment">%   param - Parameters of a               (optional, default empty)</span>
0016 <span class="comment">%   alpha - Transformation parameter      (optional)</span>
0017 <span class="comment">%   beta  - Transformation parameter      (optional)</span>
0018 <span class="comment">%   kappa - Transformation parameter      (optional)</span>
0019 <span class="comment">%   mat   - If 1 uses matrix form         (optional, default 0)</span>
0020 <span class="comment">%</span>
0021 <span class="comment">% Out:</span>
0022 <span class="comment">%   M  - Updated state mean</span>
0023 <span class="comment">%   P  - Updated state covariance</span>
0024 <span class="comment">%   K  - Computed Kalman gain</span>
0025 <span class="comment">%   MU - Predictive mean of Y</span>
0026 <span class="comment">%   S  - Predictive covariance Y</span>
0027 <span class="comment">%   LH - Predictive probability (likelihood) of measurement.</span>
0028 <span class="comment">%</span>
0029 <span class="comment">% Description:</span>
0030 <span class="comment">%   Perform additive form Discrete Unscented Kalman Filter (UKF)</span>
0031 <span class="comment">%   measurement update step. Assumes additive measurement</span>
0032 <span class="comment">%   noise.</span>
0033 <span class="comment">%</span>
0034 <span class="comment">%   Function h should be such that it can be given</span>
0035 <span class="comment">%   DxN matrix of N sigma Dx1 points and it returns</span>
0036 <span class="comment">%   the corresponding measurements for each sigma</span>
0037 <span class="comment">%   point. This function should also make sure that</span>
0038 <span class="comment">%   the returned sigma points are compatible such that</span>
0039 <span class="comment">%   there are no 2pi jumps in angles etc.</span>
0040 <span class="comment">%</span>
0041 <span class="comment">% Example:</span>
0042 <span class="comment">%   h = inline('atan2(x(2,:)-s(2),x(1,:)-s(1))','x','s');</span>
0043 <span class="comment">%   [M2,P2] = ukf_update(M1,P1,Y,h,R,S);</span>
0044 <span class="comment">%</span>
0045 <span class="comment">% See also:</span>
0046 <span class="comment">%   UKF_PREDICT1, UKF_PREDICT2, UT_TRANSFORM, UT_WEIGHTS, UT_MWEIGHTS,</span>
0047 <span class="comment">%   UT_SIGMAS</span>
0048 <span class="comment">%</span>
0049 <span class="comment">% History:</span>
0050 <span class="comment">%   04.05.2007 JH Made corrections to the description.</span>
0051 <span class="comment">%   02.05.2007 JH Fixed a bug in likelihood calculation and added</span>
0052 <span class="comment">%              a &quot;See also&quot;-section.</span>
0053 <span class="comment">%   2002-2006  SS Initial version</span>
0054 <span class="comment">%</span>
0055 <span class="comment">%</span>
0056 <span class="comment">% References:</span>
0057 <span class="comment">%   [1] Wan, Merwe: The Unscented Kalman Filter</span>
0058 
0059 <span class="comment">% Copyright (C) 2002-2006 Simo Särkkä</span>
0060 <span class="comment">%</span>
0061 <span class="comment">% $Id: ukf_update1.m,v 1.1 2006/09/26 21:32:41 ssarkka Exp $</span>
0062 <span class="comment">%</span>
0063 <span class="comment">% This software is distributed under the GNU General Public</span>
0064 <span class="comment">% Licence (version 2 or later); please refer to the file</span>
0065 <span class="comment">% Licence.txt, included with the software, for details.</span>
0066 
0067 <a name="_sub0" href="#_subfunctions" class="code">function [M,P,K,MU,S,LH] = ukf_update1(M,P,Y,h,R,param,alpha,beta,kappa,mat)</a>
0068 
0069   <span class="comment">%</span>
0070   <span class="comment">% Check that all arguments are there</span>
0071   <span class="comment">%</span>
0072   <span class="keyword">if</span> nargin &lt; 5
0073     error(<span class="string">'Too few arguments'</span>);
0074   <span class="keyword">end</span>
0075   <span class="keyword">if</span> nargin &lt; 6
0076     param = [];
0077   <span class="keyword">end</span>
0078   <span class="keyword">if</span> nargin &lt; 7
0079     alpha = [];
0080   <span class="keyword">end</span>
0081   <span class="keyword">if</span> nargin &lt; 8
0082     beta = [];
0083   <span class="keyword">end</span>
0084   <span class="keyword">if</span> nargin &lt; 9
0085     kappa = [];
0086   <span class="keyword">end</span>
0087   <span class="keyword">if</span> nargin &lt; 10
0088     mat = [];
0089   <span class="keyword">end</span>
0090 
0091   <span class="comment">%</span>
0092   <span class="comment">% Apply defaults</span>
0093   <span class="comment">%</span>
0094   <span class="keyword">if</span> isempty(mat)
0095     mat = 0;
0096   <span class="keyword">end</span>
0097 
0098   <span class="comment">%</span>
0099   <span class="comment">% Do transform and make the update</span>
0100   <span class="comment">%</span>
0101   [MU,S,C] = <a href="ut_transform.html" class="code" title="function [mu,S,C,X,Y,w] = ut_transform(M,P,g,param,alpha,beta,kappa,mat,X,w)">ut_transform</a>(M,P,h,param,alpha,beta,kappa,mat);
0102   S = S + R;
0103   K = C / S;
0104   M = M + K * (Y - MU);
0105   P = P - K * S * K';
0106   
0107   <span class="keyword">if</span> nargout &gt; 5
0108     LH = <a href="gauss_pdf.html" class="code" title="function [P,E] = gauss_pdf(X,M,S)">gauss_pdf</a>(Y,MU,S);
0109   <span class="keyword">end</span></pre></div>
<hr><address>Generated on Thu 07-Jun-2007 14:54:42 by <strong><a href="http://www.artefact.tk/software/matlab/m2html/">m2html</a></strong> &copy; 2003</address>
</body>
</html>